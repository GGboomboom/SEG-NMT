{'baseline_xy': '/root/disk/scratch/model-tmnmt/baseline_fren.npz',
 'baseline_yx': '/root/disk/scratch/model-tmnmt/baseline_enfr.bs64.npz',
 'batch_size': 32,
 'beamsize': 5,
 'build_gate': True,
 'clip_c': 1.0,
 'd_maxlen': 200,
 'datasets': ['/root/workspace/TMNMT/.dataset/tm2.fren/train.fr.top5.shuf.tok',
              '/root/workspace/TMNMT/.dataset/tm2.fren/train.en.top5.shuf.tok',
              '/root/workspace/TMNMT/.dataset/tm2.fren/train.fr.top5.matched.shuf.tok',
              '/root/workspace/TMNMT/.dataset/tm2.fren/train.en.top5.matched.shuf.tok'],
 'decay_c': 0.0,
 'decoder': 'gru_cond',
 'diagonal': True,
 'dictionaries': ['/root/workspace/TMNMT/.dataset/tm2.fren/train.fr.top5.shuf.tok.pkl',
                  '/root/workspace/TMNMT/.dataset/tm2.fren/train.en.top5.shuf.tok.pkl',
                  '/root/workspace/TMNMT/.dataset/tm2.fren/train.fr.top5.shuf.tok.pkl',
                  '/root/workspace/TMNMT/.dataset/tm2.fren/train.en.top5.shuf.tok.pkl'],
 'dim': 1024,
 'dim_word': 512,
 'dispFreq': 10,
 'encoder': 'gru',
 'gate_lambda': 0.1,
 'gate_loss': False,
 'gru_coverage': True,
 'lrate': 0.0001,
 'maxlen': 50,
 'normalize': True,
 'only_train_g': False,
 'optimizer': 'adam',
 'overwrite': True,
 'patience': 1000,
 'reload_': True,
 'sampleFreq': 20,
 'saveFreq': 500,
 'saveto': '/root/disk/scratch/model-tmnmt/10_fren.ss.32-50.npz',
 'stochastic': False,
 'tm_source': '/root/workspace/TMNMT/.dataset/tm2.fren/devset.fr.matched.tok',
 'tm_target': '/root/workspace/TMNMT/.dataset/tm2.fren/devset.en.matched.tok',
 'trans_from': '/root/workspace/TMNMT/.dataset/tm2.fren/devset.fr.tok',
 'trans_ref': '/root/workspace/TMNMT/.dataset/tm2.fren/devset.en.tok',
 'trans_to': '/root/workspace/TMNMT/.translate/TM2.v6.120k.translate',
 'use_coverage': True,
 'use_dropout': False,
 'use_pretrain': False,
 'validFreq': 250,
 'valid_batch_size': 32,
 'valid_datasets': ['/root/workspace/TMNMT/.dataset/tm2.fren/devset.fr.tok',
                    '/root/workspace/TMNMT/.dataset/tm2.fren/devset.en.tok',
                    '/root/workspace/TMNMT/.dataset/tm2.fren/devset.fr.matched.tok',
                    '/root/workspace/TMNMT/.dataset/tm2.fren/devset.en.matched.tok'],
 'voc_sizes': [20000, 20000, 20000, 20000]}
Building model: X -> Y & Y -> X model
Done.
load the pretrained NMT-models... load ... xy_Wemb
load ... xy_Wemb_dec
load ... xy_encoder_W
load ... xy_encoder_b
load ... xy_encoder_U
load ... xy_encoder_Wx
load ... xy_encoder_bx
load ... xy_encoder_Ux
load ... xy_encoder_r_W
load ... xy_encoder_r_b
load ... xy_encoder_r_U
load ... xy_encoder_r_Wx
load ... xy_encoder_r_bx
load ... xy_encoder_r_Ux
load ... xy_ff_state_W
load ... xy_ff_state_b
load ... xy_decoder_W
load ... xy_decoder_b
load ... xy_decoder_U
load ... xy_decoder_Wx
load ... xy_decoder_Ux
load ... xy_decoder_bx
load ... xy_decoder_U_nl
load ... xy_decoder_b_nl
load ... xy_decoder_Ux_nl
load ... xy_decoder_bx_nl
load ... xy_decoder_Wc
load ... xy_decoder_Wcx
load ... xy_decoder_W_comb_att
load ... xy_decoder_Wc_att
load ... xy_decoder_b_att
load ... xy_decoder_U_att
load ... xy_decoder_c_tt
load ... xy_ff_logit_lstm_W
load ... xy_ff_logit_lstm_b
load ... xy_ff_logit_prev_W
load ... xy_ff_logit_prev_b
load ... xy_ff_logit_ctx_W
load ... xy_ff_logit_ctx_b
load ... xy_ff_logit_W
load ... xy_ff_logit_b
Done.
Start a new model
build forward-attention models (2 models simultaneously)...
Build f_critic... Done
build mapping (bi-linear model)!
2
2
2
Building Mapping functions, ... Done.
build loss function (w/o gate)
build sampler (one-step)
Building f_init... Done
Building f_next... Done
build old sampler
Building f_init... Done
Building f_next... Done
build Cost Function... build Gradient (backward)... Done
Building Optimizers... Done
Build Networks... done!
build_networks: elapsed 406.7363 secs.
Loading data
[33m-------------------------------------------- Main-Loop -------------------------------------------------[0m
Epoch  0 Update  1 Cost  309.374786377 G 30.7379055023 execute: elapsed 4.1370 secs.
Epoch  0 Update  2 Cost  271.605407715 G 26.9223442078 execute: elapsed 3.6142 secs.
Epoch  0 Update  3 Cost  253.471130371 G 24.6347961426 execute: elapsed 3.5254 secs.
Epoch  0 Update  4 Cost  225.609313965 G 22.4502315521 execute: elapsed 3.3151 secs.
Epoch  0 Update  5 Cost  201.264083862 G 20.1385688782 execute: elapsed 2.6525 secs.
Epoch  0 Update  6 Cost  169.795593262 G 17.1954479218 execute: elapsed 2.3685 secs.
Epoch  0 Update  7 Cost  146.852493286 G 15.2024993896 execute: elapsed 2.0915 secs.
Epoch  0 Update  8 Cost  120.073638916 G 12.9253072739 execute: elapsed 1.1810 secs.
Epoch  0 Update  9 Cost  96.1131439209 G 12.97240448 execute: elapsed 0.9127 secs.
Epoch  0 Update  10 Cost  85.3754425049 G 15.920173645 execute: elapsed 0.7834 secs.
Epoch  0 Update  11 Cost  69.5878829956 G 10.5436601639 execute: elapsed 0.7137 secs.
Epoch  0 Update  12 Cost  51.4620018005 G 9.9199180603 execute: elapsed 1.1012 secs.
Epoch  0 Update  13 Cost  45.2396011353 G 10.7990112305 execute: elapsed 1.0006 secs.
Epoch  0 Update  14 Cost  32.8535575867 G 6.38067817688 execute: elapsed 0.8547 secs.
Epoch  0 Update  15 Cost  28.3786697388 G 3.69329071045 execute: elapsed 0.9348 secs.
Epoch  0 Update  16 Cost  132.204681396 G 30.495677948 execute: elapsed 4.7134 secs.
Epoch  0 Update  17 Cost  243.379776001 G 40.4921340942 execute: elapsed 3.9526 secs.
Epoch  0 Update  18 Cost  206.009872437 G 24.8502788544 execute: elapsed 3.5039 secs.
Epoch  0 Update  19 Cost  217.589874268 G 44.5793457031 execute: elapsed 3.2273 secs.
Epoch  0 Update  20 Cost  186.195083618 G 37.158000946 execute: elapsed 2.8646 secs.
